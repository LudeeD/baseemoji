mod utils;

use wasm_bindgen::prelude::*;

// When the `wee_alloc` feature is enabled, use `wee_alloc` as the global
// allocator.
#[cfg(feature = "wee_alloc")]
#[global_allocator]
static ALLOC: wee_alloc::WeeAlloc = wee_alloc::WeeAlloc::INIT;


pub const EMOGI : [&str; 256] = ["ðŸ”‘","ðŸ˜€","ðŸ˜","ðŸ˜‚","ðŸ˜ƒ","ðŸ˜„","ðŸ˜…","ðŸ˜†","ðŸ˜‡","ðŸ˜ˆ","ðŸ˜‰","ðŸ˜Š","ðŸ˜‹","ðŸ˜Œ","ðŸ˜","ðŸ˜Ž","ðŸ˜","ðŸ˜","ðŸ˜‘","ðŸ˜’","ðŸ˜“","ðŸ˜”","ðŸ˜•","ðŸ˜–","ðŸ˜—","ðŸ˜˜","ðŸ˜™","ðŸ˜š","ðŸ˜›","ðŸ˜œ","ðŸ˜","ðŸ˜ž","ðŸ˜Ÿ","ðŸ˜ ","ðŸ˜¡","ðŸ˜¢","ðŸ˜£","ðŸ˜¤","ðŸ˜¥","ðŸ˜¦","ðŸ˜§","ðŸ˜¨","ðŸ˜©","ðŸ˜ª","ðŸ˜«","ðŸ˜¬","ðŸ˜­","ðŸ˜®","ðŸ˜¯","ðŸ˜°","ðŸ˜±","ðŸ˜²","ðŸ˜³","ðŸ˜´","ðŸ˜µ","ðŸ˜¶","ðŸ˜·","âœ…","â™ˆ","â™‰","â™Š","â™‹","â™Œ","â™","â™Ž","â™","â™","â™‘","â™’","â™“","ðŸŒ€","ðŸŒ","ðŸŒ‚","ðŸŒƒ","ðŸŒ„","ðŸŒ…","ðŸŒ†","ðŸŒ‡","ðŸŒˆ","ðŸŒ‰","ðŸŒŠ","ðŸŒ‹","ðŸŒŒ","ðŸŒ","ðŸŒŽ","ðŸŒ","ðŸŒ","ðŸŒ‘","ðŸŒ’","ðŸŒ“","ðŸŒ”","ðŸŒ•","ðŸŒ–","ðŸŒ—","ðŸŒ˜","ðŸŒ™","ðŸŒš","ðŸŒ›","ðŸŒœ","ðŸŒ","ðŸŒž","ðŸŒŸ","ðŸŒ ","ðŸŒ¡","ðŸŒ­","ðŸŒ®","ðŸŒ¯","ðŸŒ°","ðŸŒ±","ðŸŒ²","ðŸŒ³","ðŸŒ´","ðŸŒµ","ðŸŒ¶","ðŸŒ·","ðŸŒ¸","ðŸŒ¹","ðŸŒº","ðŸŒ»","ðŸŒ¼","ðŸŒ½","ðŸŒ¾","ðŸŒ¿","ðŸ€","ðŸ","ðŸ‚","ðŸƒ","ðŸ„","ðŸ…","ðŸ†","ðŸ‡","ðŸˆ","ðŸ‰","ðŸŠ","ðŸ‹","ðŸŒ","ðŸ","ðŸŽ","ðŸ","ðŸ","ðŸ‘","ðŸ’","ðŸ“","ðŸ”","ðŸ•","ðŸ–","ðŸ—","ðŸ˜","ðŸ™","ðŸš","ðŸ›","ðŸœ","ðŸ","ðŸž","ðŸŸ","ðŸ ","ðŸ¡","ðŸ¢","ðŸ£","ðŸ¤","ðŸ¥","ðŸ¦","ðŸ§","ðŸ¨","ðŸ©","ðŸª","ðŸ«","ðŸ¬","ðŸ­","ðŸ®","ðŸ¯","ðŸ°","ðŸ±","ðŸ²","ðŸ³","ðŸ´","ðŸµ","ðŸ¶","ðŸ·","ðŸ¸","ðŸ¹","ðŸº","ðŸ»","ðŸ¼","ðŸ€","ðŸ","ðŸ‚","ðŸƒ","ðŸ„","ðŸ…","ðŸ†","ðŸ‡","ðŸˆ","ðŸ‰","ðŸŠ","ðŸ‹","ðŸŒ","ðŸ","ðŸŽ","ðŸ","ðŸ","ðŸ‘","ðŸ’","ðŸ“","ðŸ”","ðŸ•","ðŸ–","ðŸ—","ðŸ˜","ðŸ™","ðŸš","ðŸ›","ðŸœ","ðŸ","ðŸž","(","ðŸ ","ðŸ¡","ðŸ¢","ðŸ£","ðŸ¤","ðŸ¥","ðŸ’€","ðŸ§","ðŸ¨","ðŸ©","ðŸª","ðŸ«","ðŸ¬","ðŸ­","ðŸ®","ðŸ¯","ðŸ°","ðŸ±","ðŸ²","ðŸ³","ðŸ´","ðŸµ","ðŸ¶","ðŸ·","ðŸ¸","ðŸ¹","ðŸº","ðŸ»","ðŸ¼","ðŸ½","ðŸ‘†","ðŸ‘‡","ðŸ‘ˆ","ðŸ‘‰","ðŸ‘Š","ðŸ‘‹","ðŸ‘Œ","ðŸ‘","ðŸ‘Ž","ðŸ‘"];

#[wasm_bindgen]
extern {
    fn alert(s: &str);
}

#[wasm_bindgen]
pub fn greet() {
    alert("caralho");
}


#[wasm_bindgen]
pub fn encode(input: String) -> String {
    let mut output = String::new();

    for i in input.as_bytes() {
        output.push_str(EMOGI[*i as usize]);
    }





    output
}

#[wasm_bindgen]
pub fn decode(input: String) -> String {
    let mut bytes = Vec::with_capacity(input.len());

    for (i, c) in input.chars().enumerate() {
        let mut demo = EMOGI.iter();
        let s = String::from(c);

        let val = demo.position(|&x| { x == s }).expect("demo");
        bytes.push(val as u8);
    }

    String::from_utf8_lossy(&bytes).to_string()
}